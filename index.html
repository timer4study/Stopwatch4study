<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Study Timer — Stopwatch & Pomodoro</title>

  <style>
    :root{--bg:#0f1724;--accent:#60a5fa;--muted:#94a3b8}
    body{
      margin:0;
      font-family:system-ui;
      background:#071129;
      color:#e6eef8;
    }
    .wrap{
      max-width:400px;
      margin:30px auto;
      padding:20px;
      background:rgba(255,255,255,0.03);
      border-radius:18px;
    }
    h1{
      font-size:20px;
      margin:0 0 15px;
      color:var(--accent);
      text-align:center;
    }
    .display{
      font-size:42px;
      font-weight:700;
      text-align:center;
      padding:18px 0;
    }
    .controls button{
      width:100%;
      padding:12px;
      margin-top:8px;
      background:var(--accent);
      color:#04243b;
      border:0;
      border-radius:12px;
      font-weight:700;
      font-size:16px;
    }
    button.secondary{
      background:transparent;
      border:1px solid rgba(255,255,255,0.1);
      color:var(--muted);
    }
    .row{
      margin-top:14px;
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .row div{margin-top:10px}
    input{
      width:70px;
      padding:7px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.05);
      background:transparent;
      color:white;
    }
    .small{
      margin-top:10px;
      padding:8px;
      font-size:13px;
    }
    .status{margin-top:12px;color:var(--muted);font-size:14px}
    .chip{
      padding:6px 10px;
      background:rgba(255,255,255,0.05);
      border-radius:999px;
      font-weight:600;
    }
  </style>
</head>

<body>

<!-- SOUNDS -->
<audio id="sweet"><source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
<audio id="music"><source src="https://actions.google.com/sounds/v1/alarms/music_box.ogg"></audio>

<div class="wrap">

<h1>Study Timer — Stopwatch & Pomodoro</h1>

<div class="display" id="time">00:00:00.00</div>

<div class="controls">
  <button id="s">Start</button>
  <button id="p" class="secondary">Pause</button>
  <button id="r" class="secondary">Reset</button>
</div>

<div class="row">
  <div>Mode: <span class="chip" id="chip">STOPWATCH</span></div>
  <div>Work<br><input id="wm" type="number" value="25" min="1"></div>
  <div>Break<br><input id="bm" type="number" value="5" min="1"></div>
  <div>Cycles<br><input id="cy" type="number" value="4" min="1"></div>
</div>

<div class="row">
  <button id="spm" class="small">Start Pomodoro</button>
  <button id="stpm" class="small secondary">Stop Pomodoro</button>
  <button id="lap" class="small secondary">Lap</button>
</div>

<div class="status" id="st">Ready.</div>

</div>

<script>

/* ---------------- STOPWATCH ---------------- */
let run=false, start=0, el=0, intv=null;

function fmt(ms){
 let c=Math.floor(ms/10);
 let z=v=>v.toString().padStart(2,"0");
 return `${z(Math.floor(c/360000))}:${z(Math.floor(c/6000)%60)}:${z(Math.floor(c/100)%60)}.${z(c%100)}`;
}

function upd(){
 let ms=el;
 if(run) ms+=Date.now()-start;
 document.getElementById("time").textContent=fmt(ms);
}

function startSW(){
 if(run) return;
 run=true;
 start=Date.now();
 intv=setInterval(upd,40);
}

function pauseSW(){
 if(!run) return;
 el+=Date.now()-start;
 run=false;
 clearInterval(intv);
 upd();
}

function resetSW(){
 run=false;
 el=0;
 clearInterval(intv);
 upd();
}

s.onclick=startSW;
p.onclick=pauseSW;
r.onclick=resetSW;

/* ---------------- POMODORO ---------------- */
let pom=false, cycle=1, total=4, isWork=true, remain=0, pomInt=null;

function play3x(id){
 let a=document.getElementById(id);
 a.play(); setTimeout(()=>a.play(),1200); setTimeout(()=>a.play(),2400);
}

spm.onclick=()=>{

 if(pom) return;

 pom=true;
 cycle=1;
 total=parseInt(cy.value);
 isWork=true;

 chip.textContent="POMODORO";

 let work=parseInt(wm.value);
 remain=work*60;

 resetSW();
 startSW();

 st.textContent=`Work — ${work} min (Cycle 1/${total})`;

 pomInt=setInterval(()=>{
   remain--;

   let mm=String(Math.floor(remain/60)).padStart(2,'0');
   let ss=String(remain%60).padStart(2,'0');

   st.textContent=`${isWork?"Work":"Break"} — ${mm}:${ss} left (Cycle ${cycle}/${total})`;

   if(remain<=0){

     /* WORK FINISHED */
     if(isWork){
       play3x("sweet");
       isWork=false;

       let brk=parseInt(bm.value);
       if(cycle % 4 === 0) brk = 15;

       remain = brk * 60;
       resetSW(); startSW();
       st.textContent=`Work finished — Break starts`;

     } else {
       /* BREAK FINISHED */
       play3x("music");
       cycle++;

       if(cycle > total){
         st.textContent=`Pomodoro completed (${total} cycles)`;
         clearInterval(pomInt);
         pom=false;
         chip.textContent="STOPWATCH";
         pauseSW();
         return;
       }

       isWork = true;
       let work=parseInt(wm.value);
       remain = work * 60;
       resetSW(); startSW();
       st.textContent=`Break finished — Work starts`;
     }
   }
 },1000);
};

stpm.onclick=()=>{
 clearInterval(pomInt);
 pom=false;
 chip.textContent="STOPWATCH";
 st.textContent="Pomodoro stopped.";
 pauseSW();
};

</script>

</body>
  </html>
